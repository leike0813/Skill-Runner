## 1. 终端网关重构（ttyd）

- [x] 1.1 将现有 UI shell 会话管理改为 ttyd 进程管理（启动/状态/终止）
- [x] 1.2 保持单会话全局互斥，重复启动返回 busy（409）
- [x] 1.3 保持固定引擎白名单命令映射，拒绝任意命令执行
- [x] 1.4 增加 ttyd 缺失/启动失败的可诊断错误信息

## 2. UI 集成调整

- [x] 2.1 在 `/ui/engines` 中将终端区域切换为 ttyd 嵌入视图
- [x] 2.2 保留“在内嵌终端中启动 TUI / 结束终端”交互
- [x] 2.3 会话结束后清理展示状态，允许再次启动

## 3. 兼容与安全

- [x] 3.1 ttyd 监听地址与端口可配置
- [x] 3.2 保持会话隔离目录与 managed 环境变量注入
- [x] 3.3 保持现有 sandbox 状态探测与提示（非阻断）

## 4. 测试与文档

- [x] 4.1 更新单元测试（manager/routes）覆盖启动、互斥、终止、异常路径
- [x] 4.2 更新 API 文档与 README 的内嵌终端说明
- [x] 4.3 更新部署文档，声明 ttyd 依赖（本地与容器）
- [x] 4.4 执行 pytest 与 mypy 回归
